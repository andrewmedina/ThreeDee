## The ThreeDee (.ddd) Language V2

## What has changed

- I have now implemented parser logic to connect between the lexical scanner and parser for this special 3D printing language I've made called ThreeDee
  - The parser breaks down the logic according to the CFG outlined below
  - The parser (`parser.c`) takes in a list of lexical tokens generated by `scanner.l` and then generates an AST based on how they conform to the rules outlined in the CFG
- Since the parser logic was getting a bit cluttered, separate files were created for AST, parser, scanner, and utility functions.

## Usage (same as before)

1. Install Flex (`brew install Flex`) and GCC (`brew install gcc`).
2. Run `chmod +x run_scanner.sh` to make the scanner executable.
3. Execute the scanner script with a `.ddd` file as the argument, e.g.:

```
./run_scanner.sh test_1_v2.ddd
```

**NOTE:** Only test the V2 test files as the V1 files may be outdated now.

## Terminal Symbols:

### Keywords

- `CREATE`
- `IF`
- `ELSE`
- `PRINT`
- `SET`
- `WHILE`

### Symbols

- `(`
- `)`
- `{`
- `}`
- `=`
- `+`
- `-`
- `*`
- `÷`
- `<`
- `>`
- `<=`
- `>=`
- `==`
- `!=`

### Tokens

#### IDENTIFIER

Tokens starting with a lowercase letter, followed by lowercase letters, digits, or underscores.

#### INTEGER

A sequence of digits.

#### OPERATOR

Arithmetic operators `+`, `-`, `*`, or `÷`.

#### PARAMETER

Tokens with values `FAST`, `HIGH`, `LOW`, `MEDIUM`, `SLOW`, or `STRONG`.

#### SETTING

Tokens with values `INFILL`, `LAYER_HEIGHT`, or `SPEED`.

### Non-Terminal Symbols

- `Assignment`
- `Condition`
- `CreateCommand`
- `ElseBlock`
- `Expression`
- `IfStatement`
- `Operator`
- `Ops`
- `PrintCommand`
- `Program`
- `RelOp`
- `SetCommand`
- `Statement`
- `StatementBlock`
- `Statements`
- `Value`
- `WhileStatement`

## Outlined Context-Free Grammar (CFG)
The following is the CFG used to guide the development of the ThreeDee language.

- `Program` -> `Statements`
- `Statements` -> `Statement` `Statements` | ε
- `Statement` -> `IfStatement` | `WhileStatement` | `Assignment` | `CreateCommand` | `PrintCommand` | `SetCommand`
- `IfStatement` -> **IF** `(` `Condition` `)` `StatementBlock` `ElseBlock`
- `Condition` -> _IDENTIFIER_ `RelOp` `Value`
- `RelOp` -> `<` | `>` | `<=` | `>=` | `==` | `!=`
- `Value` -> _IDENTIFIER_ | _INTEGER_ | _PARAMETER_
- `StatementBlock` -> `{` `Statements` `}`
- `ElseBlock` -> **ELSE** `StatementBlock` | ε
- `WhileStatement` -> **WHILE** `(` `Condition` `)` `StatementBlock`
- `Assignment` -> _IDENTIFIER_ `=` `Expression`
- `Expression` -> `Value` `Ops`
- `Ops` -> `Operator` `Value` | ε
  - **_NOTE:_** ThreeDee can only handle operations between two values at the moment (e.g. "1 + 2" but not "1 + 2 - 3")
- `Operator` -> `+` | `-` | `*` | `÷`
- `CreateCommand` -> **CREATE** _IDENTIFIER_ _PARAMETER_
- `PrintCommand` -> **PRINT** _IDENTIFIER_
- `SetCommand` -> **SET** _SETTING_ _PARAMETER_

## Five sample input programs and their expected outputs

### test_1_v2.ddd
#### Input
```
CREATE a HIGH
IF (a < 10) {
    PRINT a
}
WHILE (a > 0) {
    a = a - 1
}
PRINT a
```
#### Output
```
Abstract Syntax Tree:
COMMAND: CREATE
  IDENTIFIER: a
  PARAMETER: HIGH
IF_STATEMENT: IF_STATEMENT
  CONDITION: CONDITION
    IDENTIFIER: a
    OPERATOR: <
    INTEGER: 10
  STATEMENT_BLOCK: STATEMENT_BLOCK
    PRINT: PRINT
      IDENTIFIER: a
WHILE: WHILE
  CONDITION: CONDITION
    IDENTIFIER: a
    OPERATOR: >
    INTEGER: 0
  STATEMENT_BLOCK: STATEMENT_BLOCK
    ASSIGNMENT: ASSIGNMENT
      IDENTIFIER: a
      ASSIGN: =
      EXPRESSION: EXPRESSION
        IDENTIFIER: a
        OPERATOR: -
        INTEGER: 1
PRINT: PRINT
  IDENTIFIER: a
```
### test_2_v2.ddd
#### Input
```
CREATE a LOW
CREATE b MEDIUM
IF (a < b) { 
    PRINT a
} ELSE {
    SET INFILL LOW
    PRINT b
}
```
#### Output
```
Abstract Syntax Tree:
COMMAND: CREATE
  IDENTIFIER: a
  PARAMETER: LOW
COMMAND: CREATE
  IDENTIFIER: b
  PARAMETER: MEDIUM
IF_STATEMENT: IF_STATEMENT
  CONDITION: CONDITION
    IDENTIFIER: a
    OPERATOR: <
    IDENTIFIER: b
  STATEMENT_BLOCK: STATEMENT_BLOCK
    PRINT: PRINT
      IDENTIFIER: a
ELSE_STATEMENT: ELSE_STATEMENT
  STATEMENT_BLOCK: STATEMENT_BLOCK
    COMMAND: SET
      SETTING: INFILL
      PARAMETER: LOW
    PRINT: PRINT
      IDENTIFIER: b
```
### test_3_v2.ddd
#### Input
```
CREATE a HIGH
WHILE (a >= LOW) {
    IF (a == MEDIUM) {
        PRINT a
    }
    a = a - 2
}
PRINT a
```
#### Output
```
Abstract Syntax Tree:
COMMAND: CREATE
  IDENTIFIER: a
  PARAMETER: HIGH
WHILE: WHILE
  CONDITION: CONDITION
    IDENTIFIER: a
    OPERATOR: >=
    PARAMETER: LOW
  STATEMENT_BLOCK: STATEMENT_BLOCK
    IF_STATEMENT: IF_STATEMENT
      CONDITION: CONDITION
        IDENTIFIER: a
        OPERATOR: ==
        PARAMETER: MEDIUM
      STATEMENT_BLOCK: STATEMENT_BLOCK
        PRINT: PRINT
          IDENTIFIER: a
    ASSIGNMENT: ASSIGNMENT
      IDENTIFIER: a
      ASSIGN: =
      EXPRESSION: EXPRESSION
        IDENTIFIER: a
        OPERATOR: -
        INTEGER: 2
PRINT: PRINT
  IDENTIFIER: a
```
### test_4_v2.ddd
#### Input
```
CREATE a LOW
IF (a == LOW) {
    WHILE (a <= MEDIUM) {
        a = a + 1
    }
}
PRINT a
```
#### Output
```
Abstract Syntax Tree:
COMMAND: CREATE
  IDENTIFIER: a
  PARAMETER: LOW
IF_STATEMENT: IF_STATEMENT
  CONDITION: CONDITION
    IDENTIFIER: a
    OPERATOR: ==
    PARAMETER: LOW
  STATEMENT_BLOCK: STATEMENT_BLOCK
    WHILE: WHILE
      CONDITION: CONDITION
        IDENTIFIER: a
        OPERATOR: <=
        PARAMETER: MEDIUM
      STATEMENT_BLOCK: STATEMENT_BLOCK
        ASSIGNMENT: ASSIGNMENT
          IDENTIFIER: a
          ASSIGN: =
          EXPRESSION: EXPRESSION
            IDENTIFIER: a
            OPERATOR: +
            INTEGER: 1
PRINT: PRINT
  IDENTIFIER: a
```
### test_5_v2.ddd
#### Input
```
CREATE a MEDIUM
CREATE b HIGH
SET SPEED HIGH
IF (a == b) { 
    a = b - 1
}
PRINX a
```
#### Output
```
Syntax error: Unexpected token 'PRINX'
```
